
Analysis Description
--------------------
BUSTED (branch-site unrestricted statistical test of episodic
diversification) uses a random effects branch-site model fitted jointly
to all or a subset of tree branches in order to test for alignment-wide
evidence of episodic diversifying selection. Assuming there is evidence
of positive selection (i.e. there is an omega > 1), BUSTED will also
perform a quick evidence-ratio style analysis to explore which
individual sites may have been subject to selection. v2.0 adds support
for synonymous rate variation, and relaxes the test statistic to 0.5
(chi^2_0 + chi^2_2). Version 2.1 adds a grid search for the initial
starting point. Version 2.2 changes the grid search to LHC, and adds an
initial search phase to use adaptive Nedler-Mead. Version 3.0 implements
the option for branch-site variation in synonymous substitution rates.
Version 3.1 adds HMM auto-correlation option for SRV, and binds SRV
distributions for multiple branch sets. Version 4.0 adds support for
multiple hits (MH), ancestral state reconstruction saved to JSON, and
profiling of branch-site level support for selection / multiple hits.
Version 4.2 adds calculation of MH-attributable fractions of
substitutions. Version 4.5 adds an 'error absorption' component
[experimental] 

- __Requirements__: in-frame codon alignment and a phylogenetic tree (optionally annotated
with {})

- __Citation__: *Gene-wide identification of episodic selection*, Mol Biol Evol.
32(5):1365-71, *Synonymous Site-to-Site Substitution Rate Variation
Dramatically Inflates False Positive Rates of Selection Analyses: Ignore
at Your Own Peril*, Mol Biol Evol. 37(8):2430-2439

- __Written by__: Sergei L Kosakovsky Pond

- __Contact Information__: spond@temple.edu

- __Analysis Version__: 4.5


>code => Universal

-------
>[WARNING]
'/home/malaevleo/mitimpair_pal2nal_noen/NP_001274364.1_bat_only_aligned_nucleotide_codon_aligned.fasta'
contains 4 duplicate sequences. Identical sequences do not contribute
any information to the analysis and only slow down computation. Please
consider removing duplicate or 'nearly' duplicate sequences, e.g. using
https://github.com/veg/hyphy-analyses/tree/master/remove-duplicates
prior to running selection analyses
-------
/home/malaevleo/mitimpair_trees_labeled/NP_001274364.1_bat_only_aligned_nucleotide_codon_aligned.fasta_pruned.nwk
mitimpair_trees_labeled/NP_001274364.1_bat_only_aligned_nucleotide_codon_aligned.fasta_pruned.nwk

>Loaded a multiple sequence alignment with **17** sequences, **88** codons, and **1** partitions from `/home/malaevleo/mitimpair_pal2nal_noen/NP_001274364.1_bat_only_aligned_nucleotide_codon_aligned.fasta`

>branches => Foreground

>srv => Yes
The number omega rate classes to include in the model (permissible range = [1,10], default value = 3, integer): 
>rates => 3

>multiple-hits => None
The number alpha rate classes to include in the model [1-10, default 3] (permissible range = [1,10], default value = 3, integer): 
>syn-rates => 3

>error-sink => Yes
The number of points in the initial distributional guess for likelihood fitting (permissible range = [1,10000], default value = 250, integer): 
>grid-size => 250
The number of initial random guesses to 'seed' rate values optimization (permissible range = [1,25], default value = 1, integer): 
>starting-points => 1


### Branches to test for selection in the BUSTED analysis
* Selected 6 branches to test in the BUSTED analysis: `rfXP_032984480_1, drXP_024433325_2, mbXP_014395140_1, mlXP_014317455_1, mdXP_059522974_1, mmXP_036201828_1`


### Obtaining branch lengths and nucleotide substitution biases under the nucleotide GTR model

>kill-zero-lengths => Yes

### Deleted 6 zero-length internal branches: `AjPh, Myodm, Pipistrellus, Pteropusgv, Yangochiroptera, YangochiropteraAfterSaccopteryx`
* Log(L) = -1138.25, AIC-c =  2355.20 (39 estimated parameters)
* 1 partition. Total tree length by partition (subs/site)  1.403

### Obtaining the global omega estimate based on relative GTR branch lengths and nucleotide substitution biases
* Log(L) = -1065.56, AIC-c =  2215.49 (41 estimated parameters)
* 1 partition. Total tree length by partition (subs/site)  1.954
* non-synonymous/synonymous rate ratio for *background* =   0.0992
* non-synonymous/synonymous rate ratio for *test* =   0.1051

### Improving branch lengths, nucleotide substitution biases, and global dN/dS ratios under a full codon model
* Log(L) = -1044.12, AIC-c =  2172.60 (41 estimated parameters)
* non-synonymous/synonymous rate ratio for *background* =   0.0275
* non-synonymous/synonymous rate ratio for *test* =   0.0445

### Performing the full (dN/dS > 1 allowed) branch-site model fit
* Log(L) = -1026.75, AIC-c =  2174.26 (58 estimated parameters)
* For *test* branches, the following rate distribution for branch-site combinations was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.003     |   62.991    |                                   |
|        Negative selection         |     0.095     |   26.426    |                                   |
|      Diversifying selection       |     2.227     |   10.583    |                                   |
|         Error absorption          |    109.690    |    0.000    |       Not supported by data       |

* For *background* branches, the following rate distribution for branch-site combinations was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.000     |   77.444    |                                   |
|        Negative selection         |     0.135     |   22.556    |                                   |
|      Diversifying selection       |     3.620     |    0.000    |       Not supported by data       |
|         Error absorption          |    112.752    |    0.000    |       Not supported by data       |

* The following rate distribution for site-to-site **synonymous** rate variation was inferred

|               Rate                | Proportion, % |               Notes               |
|-----------------------------------|---------------|-----------------------------------|
|               0.644               |    85.669     |                                   |
|               0.646               |     3.386     |       Collapsed rate class        |
|               3.894               |    10.945     |                                   |


### Performing the constrained (dN/dS > 1 not allowed) model fit
* Log(L) = -1025.40, AIC-c =  2169.40 (57 estimated parameters)
* For *test* branches under the null (no dN/dS > 1 model), the following rate distribution for branch-site combinations was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.000     |   39.195    |                                   |
|        Negative selection         |     0.023     |   46.556    |                                   |
|         Neutral evolution         |     1.000     |   14.250    |                                   |
|         Error absorption          |    109.093    |    0.000    |       Not supported by data       |

* The following rate distribution for site-to-site **synonymous** rate variation was inferred

|               Rate                | Proportion, % |               Notes               |
|-----------------------------------|---------------|-----------------------------------|
|               0.222               |    29.212     |                                   |
|               0.739               |    58.327     |                                   |
|               4.044               |    12.461     |                                   |

----
## Negative test LRT (convergence problem). Refitting the alternative model using the null model as a start.
----

* Log(L) = -1025.23, AIC-c =  2171.22 (58 estimated parameters)
* For *test* branches, the following rate distribution for branch-site combinations was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.000     |   39.690    |                                   |
|        Negative selection         |     0.023     |   47.798    |                                   |
|      Diversifying selection       |     1.506     |   12.513    |                                   |
|         Error absorption          |    113.880    |    0.000    |       Not supported by data       |

* For *background* branches, the following rate distribution for branch-site combinations was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.000     |   74.261    |                                   |
|        Negative selection         |     0.103     |   25.739    |                                   |
|      Diversifying selection       |     2.292     |    0.000    |       Not supported by data       |
|         Error absorption          |    113.897    |    0.000    |       Not supported by data       |

* The following rate distribution for site-to-site **synonymous** rate variation was inferred

|               Rate                | Proportion, % |               Notes               |
|-----------------------------------|---------------|-----------------------------------|
|               0.205               |    30.912     |                                   |
|               0.740               |    56.710     |                                   |
|               4.177               |    12.378     |                                   |

Performing the constrained (dN/dS > 1 not allowed) model fit
* Log(L) = -1025.26, AIC-c =  2169.12 (57 estimated parameters)
* For *test* branches under the null (no dN/dS > 1 model), the following rate distribution for branch-site combinations was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.000     |   39.457    |                                   |
|        Negative selection         |     0.020     |   46.369    |                                   |
|         Neutral evolution         |     1.000     |   14.174    |                                   |
|         Error absorption          |    176.228    |    0.000    |       Not supported by data       |

* The following rate distribution for site-to-site **synonymous** rate variation was inferred

|               Rate                | Proportion, % |               Notes               |
|-----------------------------------|---------------|-----------------------------------|
|               0.193               |    30.029     |                                   |
|               0.756               |    57.649     |                                   |
|               4.107               |    12.322     |                                   |

----
## Branch-site unrestricted statistical test of episodic diversification [BUSTED]
Likelihood ratio test for episodic diversifying positive selection, **p =   0.4840**.
